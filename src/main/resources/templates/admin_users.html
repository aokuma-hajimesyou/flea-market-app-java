<!DOCTYPE html>
<html lang="ja" xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.thymeleaf.org/extras/spring-security">

<head>
	<meta charset="UTF-8">
	<title>管理者: ユーザー管理 - フリマアプリ</title>
	<link rel="stylesheet" th:href="@{/css/style.css}">
</head>

<body>
	<div class="container">
		<h1>管理者: ユーザー管理</h1>
		<p>システム内の全てのユーザーを管理します。</p>
		<table>
			<thead>
				<tr>
					<th>ID</th>
					<th>名前</th>
					<th>メールアドレス</th>
					<th>役割</th>
					<th>有効状態</th> 
					<th>操作</th>
				</tr>
			</thead>
			<tbody>
				<tr th:each="user : ${users}">
					<td th:text="${user.id}"></td>
					<td th:text="${user.name}"></td>
					<td th:text="${user.email}"></td>
					<td th:text="${user.role}"></td>
					
					<td th:text="${user.banned ? '無効' : '有効'}"></td>
					
					<td>
					    <form th:if="${!user.banned}" 
					        th:action="@{/admin/users/{id}/ban(id=${user.id})}" method="post"
					        style="display:inline;">
					        <input type="hidden" name="reason" value="管理者による一時的な無効" />
					        <input type="hidden" name="disableLogin" value="true" />
					        <button type="submit" class="button danger"
					            th:text="'無効にする'"
					            onclick="return confirm('本当にこのユーザーを無効にしますか？');">
					        </button>
					    </form>
					    
					    <form th:if="${user.banned}" 
					        th:action="@{/admin/users/{id}/unban(id=${user.id})}" method="post"
					        style="display:inline;">
					        <button type="submit" class="button secondary"
					            th:text="'無効解除'"
					            onclick="return confirm('本当にこのユーザーの無効状態を解除しますか？');">
					        </button>
					    </form>
					</td>
				</tr>
				<tr th:if="${#lists.isEmpty(users)}">
					<td colspan="6">ユーザーがいません。</td>
				</tr>
			</tbody>
		</table>
		<div class="button-group">
			<a th:href="@{/dashboard}" class="button secondary">管理者ダッシュボードに戻る</a>
		</div>
	</div>
</body>

</html>