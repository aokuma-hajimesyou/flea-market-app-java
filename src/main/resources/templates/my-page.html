<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">

<head>
    <meta charset="UTF-8">
    <title>マイページ - MarketApp</title>
    <link rel="stylesheet" th:href="@{/css/style.css}">
	<script th:src="@{/js/style.js}" defer></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>

<body>
	<header class="app-header">
	    <div class="header-inner">
	        <h1 class="app-title"><a th:href="@{/items}">MarketApp</a></h1>

	        <div class="header-actions">
	            <div class="notification-container">
	                <a href="javascript:void(0)" class="header-link notification-icon" id="notificationBtn">
	                    <i class="fas fa-bell"></i>
	                    <span class="badge" th:if="${unreadCount > 0}" th:text="${unreadCount}"></span>
	                </a>

	                <div class="notification-modal" id="notificationModal">
	                    <div class="modal-header">
	                        <span>通知</span>
	                        <a th:href="@{/notifications/mark-all-read}" class="mark-all-link">すべて削除</a>
	                    </div>
	                    <div class="modal-body">
	                        <div th:each="n : ${notifications}" class="notification-item unread">
	                            <a th:href="@{/notifications/{id}/read(id=${n.id})}">
	                                <div class="notif-title" th:text="${n.title}">タイトル</div>
	                                <div class="notif-message" th:text="${n.message}">メッセージ内容</div>
	                                <div class="notif-time" th:if="${n.createdAt != null}" 
	                                     th:text="${#temporals.format(n.createdAt, 'MM/dd HH:mm')}">12/27 15:00</div>
	                            </a>
	                        </div>
	                        <div th:if="${#lists.isEmpty(notifications)}" class="no-notif">
	                            現在、通知はありません。
	                        </div>
	                    </div>
	                </div>
	            </div>

	            <form th:action="@{/logout}" method="post" style="display:inline;" class="logout-form">
	                <button type="submit" class="logout-btn" style="background:none; border:none; cursor:pointer;">
	                    <i class="fas fa-sign-out-alt"></i>
	                </button>
	            </form>
	        </div>
	    </div>
	</header>

    <div class="container">
        <h1>マイページ</h1>
        <p style="margin-bottom: 20px;">ようこそ、<strong th:text="${user.name}"></strong>さん</p>
		
		<div th:if="${successMessage}" class="status-badge status-shipped" 
							     style="width: 100%; padding: 10px; margin-bottom: 20px; text-align: center; border-radius: 5px;">
							    <i class="fas fa-check-circle"></i> <span th:text="${successMessage}"></span>
							</div>

        <section class="profile-card">
            <h2>アカウント情報</h2>
            <dl class="profile-info">
                <dt>名前</dt>
                <dd th:text="${user.name}"></dd>
                
                <dt>メール</dt>
                <dd th:text="${user.email}"></dd>
            </dl>
        </section>

        <nav class="mypage-nav">
            <a th:href="@{/my-page/selling}" class="button">
                <i class="fas fa-box-open" style="margin-right: 8px;"></i>出品管理
            </a>
            <a th:href="@{/my-page/orders}" class="button">
                <i class="fas fa-shopping-bag" style="margin-right: 8px;"></i>購入履歴
            </a>
            <a th:href="@{/my-page/sales}" class="button">
                <i class="fas fa-yen-sign" style="margin-right: 8px;"></i>販売履歴
            </a>
            <a th:href="@{/my-page/favorites}" class="button">
                <i class="fas fa-heart" style="margin-right: 8px;"></i>お気に入り
            </a>
            <a th:href="@{/my-page/following}" class="button">
                <i class="fas fa-user-friends" style="margin-right: 8px;"></i>フォロー中
            </a>
            <a th:href="@{/my-page/reviews}" class="button">
                <i class="fas fa-star" style="margin-right: 8px;"></i>自分の評価
            </a>

			
			<a th:href="@{/my-page/feedback}" class="button">
			    <i class="fas fa-envelope"></i> お問い合わせはこちら
			</a>
			
			<a th:href="@{/items}" onclick="if(document.referrer.includes('/items')) { history.back(); return false; }" class="button secondary">
                <i class="fas fa-list" style="margin-right: 8px;"></i>商品一覧に戻る
            </a>
			
            
            
        </nav>
    </div>

    <div style="height: 40px;"></div>
	

	
</body>

</html>